<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Vision Guided Gating System</title>
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="main.js" defer></script>
  <script defer>
    document.addEventListener("DOMContentLoaded", () => {
      if (typeof particlesJS !== 'undefined') {
        particlesJS('particles-js', {
          particles: {
            number: { value: 80, density: { enable: true, value_area: 800 } },
            color: { value: '#00c8ff' },
            shape: { type: 'circle' },
            opacity: { value: 0.5 },
            size: { value: 3, random: true },
            line_linked: {
              enable: true,
              distance: 150,
              color: '#00c8ff',
              opacity: 0.4,
              width: 1
            },
            move: {
              enable: true,
              speed: 6,
              direction: 'none',
              random: false,
              straight: false,
              out_mode: 'out',
              bounce: false
            }
          },
          interactivity: {
            detect_on: 'canvas',
            events: {
              onhover: { enable: true, mode: 'repulse' },
              onclick: { enable: true, mode: 'push' },
              resize: true
            }
          },
          retina_detect: true
        });
      }
      const tabs = document.querySelectorAll(".tab-btn");
      const sections = document.querySelectorAll(".pipeline-step");
      tabs.forEach(btn => {
        btn.addEventListener("click", () => {
          tabs.forEach(b => b.classList.remove("active"));
          sections.forEach(s => s.classList.remove("active"));
          btn.classList.add("active");
          document.getElementById(btn.dataset.tab).classList.add("active");
        });
      });
    });
  </script>
  <style>
    .pipeline-section {
      padding: 4rem 2rem;
      background-color: transparent;
    }
    .tab-nav {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
      margin-bottom: 3rem;
    }
    .tab-btn {
      padding: 1rem 2rem;
      border: none;
      background: transparent;
      border-radius: var(--radius-md);
      color: var(--text-secondary); /* make text faded when inactive */
      cursor: pointer;
      transition: all var(--transition-fast);
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    .tab-btn::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      transition: width var(--transition-fast);
    }

    .tab-btn:hover::after {
      width: 100%;
    }

    .tab-btn.active {
      color: var(--text-primary);
      background: linear-gradient(90deg, var(--primary), var(--secondary));
    }

    .tab-btn.active::after {
      width: 100%;
    }


    .tab-btn:hover:not(.active) {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-primary);
    }

    .pipeline-step {
      display: none;
    }
    .pipeline-step.active {
      display: block;
    }


  </style>

</head>
<body style="position: relative; min-height: 100vh; overflow-x: hidden; background-color: var(--background);">
  <div class="app-container" style="position: realtive; z-index: 1; background-color: transparent;">
    <nav class="navbar" style="position: relative; z-index: 1000; justify-content: center;">
  <div class="logo" style="padding: 1.5rem 2rem; text-align: center; position: sticky;">
    Vision-Guided <span class="highlight">Gating System</span>
  </div>
</nav>


<section class="pipeline-section" style="position: sticky; padding-top: 0rem; background-color: transparent;">
            <nav class="tabbar" style="position: sticky; top: 0%; background: transparent; z-index: 900; display: flex; justify-content: center; gap: 2rem; flex-wrap: wrap; border-bottom: 1px solid var(--border-color); padding: 1rem 2rem;">
  <a class="nav-link tab-btn active" data-tab="upload">Establish Baseline</a>
  <a class="nav-link tab-btn" data-tab="analyze">Setup Zones</a>
  <a class="nav-link tab-btn" data-tab="preprocess">Control Beam</a>
</nav>

    <div class="tab-panel active" id="upload">
        <div class="baseline-container">
            <div class="step-card">
                <div class="logo" style="padding: 1.5rem 2rem; text-align: center;">
                    Upload<span class="highlight"> Test Video</span>
                </div>
            </div>
            
            <!-- Upload Zone -->
            <div class="upload-zone" id="uploadZone">
                <div class="upload-content">
                    <div class="upload-icon">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <h3>Upload Video File</h3>
                    <p>Drag and drop your video file here or click to browse</p>
                    <p class="upload-limit">Supported formats: MP4, AVI, MOV (Max: 100MB)</p>
                </div>
                <input type="file" id="videoInput" accept="video/*" style="display: none;">
            </div>

            <!-- Upload Progress -->
            <div class="upload-progress hidden" id="uploadProgress">
                <div class="progress-info">
                    <span id="progressStatus">Uploading...</span>
                    <span id="progressPercentage">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="upload-spinner">
                    <div class="spinner"></div>
                    <span>Processing video...</span>
                </div>
            </div>

            <!-- Video Preview -->
            <div class="video-preview hidden" id="videoPreview">
                <h3>Baseline Frame Preview</h3>
                <div class="baseline-frame-container">
                    <div class="frame-display">
                        <img id="baselineFrame" class="baseline-image" alt="First frame of uploaded video">
                    </div>
                    <div class="baseline-info">
                        <div class="info-item">
                            <span class="info-label">File Name:</span>
                            <span class="info-value" id="videoName">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Duration:</span>
                            <span class="info-value" id="videoDuration">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Resolution:</span>
                            <span class="info-value" id="videoResolution">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Frame Rate:</span>
                            <span class="info-value" id="videoFps">-</span>
                        </div>
                    </div>
                </div>
                <div class="baseline-actions">
                    <button class="btn btn-outline" id="uploadNewBtn">
                        <i class="fas fa-upload"></i>
                        Upload New Video
                    </button>
                    <button class="btn btn-primary" id="confirmBaselineBtn">
                        <i class="fas fa-check"></i>
                        Confirm Baseline
                    </button>
                </div>
            </div>
        </div>
    </div>



    <!-- Setup Zones Tab -->
    <div class="tab-panel" id="analyze">
        <div class="zones-container">
            <div class="zones-header">
                <h2>Setup <span class="highlight">Critical Zones</span></h2>
                <p>Define motion detection zones on your baseline frame</p>
            </div>

            <!-- Zone Drawing Canvas -->
            <div class="canvas-section">
                <div class="canvas-controls">
                    <div class="drawing-controls">
                        <button class="btn btn-primary" id="startDrawingBtn">
                            <i class="fas fa-pencil-alt"></i>
                            Start Drawing Zone
                        </button>
                        <button class="btn btn-outline" id="clearPointsBtn" disabled>
                            <i class="fas fa-eraser"></i>
                            Clear Points
                        </button>
                        <button class="btn btn-outline" id="undoPointBtn" disabled>
                            <i class="fas fa-undo"></i>
                            Undo Last Point
                        </button>
                    </div>
                    <div class="drawing-status">
                        <span id="drawingStatus">Click "Start Drawing" to begin</span>
                        <span id="pointsCount">Points: 0</span>
                    </div>
                </div>

                <div class="canvas-container">
                    <canvas id="zoneCanvas" class="zone-canvas"></canvas>
                    <div class="canvas-overlay" id="canvasOverlay">
                        <div class="drawing-instructions">
                            <i class="fas fa-mouse-pointer"></i>
                            <p>Click on the image to add zone boundary points</p>
                            <p><strong>Tip:</strong> You need at least 3 points to create a zone</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Zone Configuration Form -->
            <div class="zone-config-form" id="zoneConfigForm">
                <div class="form-header">
                    <h3>Configure Zone</h3>
                    <p>Set parameters for your new detection zone</p>
                </div>
                <form id="zoneForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="zoneName">Zone Name</label>
                            <input type="text" id="zoneName" placeholder="e.g., critical, lung, heart" required>
                        </div>
                        <div class="form-group">
                            <label for="zonePriority">Priority Level</label>
                            <select id="zonePriority">
                                <option value="1">1 - Critical (Highest)</option>
                                <option value="2">2 - High</option>
                                <option value="3" selected>3 - Medium</option>
                                <option value="4">4 - Low</option>
                                <option value="5">5 - Monitoring Only</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="motionThreshold">Motion Threshold</label>
                            <input type="range" id="motionThreshold" min="10" max="50" value="25">
                            <span class="range-value" id="thresholdValue">25</span>
                        </div>
                        <div class="form-group">
                            <label for="minArea">Minimum Area (pixels)</label>
                            <input type="range" id="minArea" min="100" max="2000" value="500" step="50">
                            <span class="range-value" id="areaValue">500</span>
                        </div>
                        <div class="form-group">
                            <label for="motionFrames">Motion Frames</label>
                            <input type="range" id="motionFrames" min="1" max="10" value="3">
                            <span class="range-value" id="framesValue">3</span>
                        </div>
                        <div class="form-group">
                            <label for="zoneColor">Zone Color</label>
                            <select id="zoneColor">
                                <option value="#FF0000">Red</option>
                                <option value="#FF8000">Orange</option>
                                <option value="#FFFF00">Yellow</option>
                                <option value="#00FF00">Green</option>
                                <option value="#0000FF">Blue</option>
                                <option value="#8000FF">Purple</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" id="cancelZoneBtn">
                            <i class="fas fa-times"></i>
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i>
                            Save Zone
                        </button>
                    </div>
                </form>
            </div>

            <!-- Existing Zones List -->
            <div class="zones-list" id="zonesList">
                <div class="zones-list-header">
                    <h3>Configured Zones</h3>
                    <div class="zones-actions">
                        <button class="btn btn-outline btn-sm" id="exportZonesBtn">
                            <i class="fas fa-download"></i>
                            Export Config
                        </button>
                        <button class="btn btn-outline btn-sm" id="importZonesBtn">
                            <i class="fas fa-upload"></i>
                            Import Config
                        </button>
                        <input type="file" id="importZonesInput" accept=".json" style="display: none;">
                    </div>
                </div>
                <div class="zones-grid" id="zonesGrid">
                    <div class="empty-zones">
                        <i class="fas fa-draw-polygon"></i>
                        <p>No zones configured yet</p>
                        <p>Start by drawing your first detection zone</p>
                    </div>
                </div>
            </div>
        </div>
    </div>


      <div id="preprocess" class="pipeline-step">
        <div class="step-card">
          <div class="logo" style="padding:1.5rem 2rem;text-align:center;">
            Control<span class="highlight"> Radiation Beam</span>
          </div>
        </div>
      </div>


      </div>
    </section>
  </div>
<style>
  html, body {
  height: 100%;
  min-height: 100vh;
  margin: 0;
  padding: 0;
  overflow-x: hidden;
}
  .particles-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    pointer-events: none;
    background: transparent;
  }
</style>
</body>
</html>
